---
title: "Speech Classification Visualizations"
author: "Henry Nomeland"
date: "2024-02-01"
output: html_document
---

```{r setup, include=F}
knitr::opts_chunk$set(echo = T, warning=F, message=F)
```

```{r, echo=F}
library(tidyverse)
```

```{r, echo=F}
custom_pal = c("#D04848", "#6895D2", "#F3B95F", "#FDE767")
df = read.csv('input_df.csv')
demo_features = c("id", "gender", "age", "location")
summary_df = df |> mutate(F1_mean = rowMeans(select(df, starts_with("F1"))),
                           F2_mean = rowMeans(select(df, starts_with("F2"))),
                           F3_mean = rowMeans(select(df, starts_with("F3"))),
                           du_mean = rowMeans(select(df, starts_with("du"))),
                           gender = factor(gender, levels=c(0,1), labels=c("F", "M"))) |> 
  select(demo_features, F1_mean, F2_mean, F3_mean) |> 
  pivot_longer(cols=c(F1_mean, F2_mean, F3_mean))

summary_df |> ggplot(aes(x=age, y=value, color=gender)) +
  geom_point(shape=16, size=2.5, alpha=0.5) +
  labs(x="Age", y="Hertz", color="Gender", shape="Formant Means") +
  scale_color_manual(values=custom_pal)
```


```{r, echo=F}
new_pal = c("#D04848", "#001861", "#F3B95F", "#FDE767")
imp_words1 = c("small", "ask", "also", "call", "and", "plastic", "slabs", "bob",
               "frog", "toy", "go")
imp_words2 = c("small", "call")

new_df = df |> 
  select(demo_features, starts_with("F1"), starts_with("F2"), starts_with("F3"), starts_with("du")) |> 
  pivot_longer(cols=c(starts_with("F1"), starts_with("F2"), starts_with("F3"), starts_with("du"))) |> 
  separate(name, c("formant", "word")) |> 
  pivot_wider(names_from=formant, values_from=value) 

new_df |> 
  mutate(gender = factor(gender, levels=c(0,1), labels=c("F", "M"))) |> 
  filter(word %in% imp_words2) |> 
  select(demo_features, F1) |> 
  ggplot(aes(x=F1, fill=gender)) +
  geom_density(alpha=0.3) +
  labs(title="Pitch Comparison of 'Small' and 'Call' Vowels by Gender", x="F1", y="")
```

```{r, echo=F}
new_df |> 
  mutate(region = case_when (location == "uk" ~ "UK",
                             # location == "australia" ~ "Australia",
                             location %in% c('texas', 'california', 'newyork', 'minnesota') ~ "Selected USA",
                             TRUE ~ 'elsewhere')) |> 
  mutate(importance = case_when(word %in% imp_words2 ~ "important",
                                TRUE ~ "unimportant")) |> 
  filter(importance=="important", region != 'elsewhere') |> 
  ggplot(aes(x=F1, y=du, color=region, shape=word)) +
  geom_point(size=2.5, alpha=0.8) +
  labs(title="Comparison of American and British Father-Bother Merger Sounds", 
       x="F1", y="Duration", color="Region", shape="Word") +
  scale_color_manual(values=new_pal) +
  theme(plot.title = element_text(face="bold"),
        axis.title.x = element_text(face="bold"),
        axis.title.y = element_text(face="bold"))
```

```{r, echo=F}
imp_words3 = c("call", "small")
new_df |> 
  mutate(region = case_when (location == "uk" ~ "UK",
                             # location == "australia" ~ "Australia",
                             location %in% c('texas', 'california', 'newyork', 'minnesota') ~ "Selected USA",
                             TRUE ~ 'elsewhere')) |> 
  mutate(importance = case_when(word %in% imp_words3 ~ "important",
                                TRUE ~ "unimportant")) |> 
  filter(importance=="important", region != 'elsewhere', F2<1700) |> 
  ggplot(aes(x=F1, y=F2, color=region)) +
  geom_point(size=2.5, alpha=0.8) +
  labs(title="Comparison of American and British Father-Bother Merger Sounds", 
       x="F1", y="F2", color="Region") +
  scale_color_manual(values=new_pal) +
  theme(plot.title = element_text(face="bold"),
        axis.title.x = element_text(face="bold"),
        axis.title.y = element_text(face="bold")) +
  facet_wrap(vars(word))
```

```{r, echo=F}
new_df |> 
  mutate(region = case_when (location == "australia" ~ "Australia",
                             location %in% c('texas', 'california', 'newyork', 'minnesota') ~ "Selected USA",
                             TRUE ~ 'elsewhere')) |> 
  mutate(importance = case_when(word %in% imp_words2 ~ "important",
                                TRUE ~ "unimportant")) |> 
  filter(importance=="important", region != 'elsewhere') |> 
  ggplot(aes(x=F1, y=du, color=region, shape=word)) +
  geom_point(size=2.5, alpha=0.8) +
  labs(title="Comparison of American and Australian Father-Bother Merger Sounds", 
       x="F1", y="Duration", color="Region", shape="Word") +
  scale_color_manual(values=new_pal) +
  theme(plot.title = element_text(face="bold"),
        axis.title.x = element_text(face="bold"),
        axis.title.y = element_text(face="bold"))
```

```{r, echo=F}
imp_words3 = c("call", "small")
new_df |> 
  mutate(region = case_when (location == "australia" ~ "Australia",
                             location %in% c('texas', 'california', 'newyork', 'minnesota') ~ "Selected USA",
                             TRUE ~ 'elsewhere')) |> 
  mutate(importance = case_when(word %in% imp_words3 ~ "important",
                                TRUE ~ "unimportant")) |> 
  filter(importance=="important", region != 'elsewhere', F2<1700) |> 
  ggplot(aes(x=F1, y=F2, color=region)) +
  geom_point(size=2.5, alpha=0.8) +
  labs(title="Comparison of American and Australian Father-Bother Merger Sounds", 
       x="F1", y="F2", color="Region") +
  scale_color_manual(values=new_pal) +
  theme(plot.title = element_text(face="bold"),
        axis.title.x = element_text(face="bold"),
        axis.title.y = element_text(face="bold")) +
  facet_wrap(vars(word))
```

```{r, echo=F}
imp_words3 = c("also", "ask")
new_df |> 
  mutate(region = case_when (location == "uk" ~ "UK",
                             # location == "australia" ~ "Australia",
                             location %in% c('texas', 'california', 'newyork', 'minnesota') ~ "Selected USA",
                             TRUE ~ 'elsewhere')) |> 
  mutate(importance = case_when(word %in% imp_words3 ~ "important",
                                TRUE ~ "unimportant")) |> 
  filter(importance=="important", region != 'elsewhere') |> 
  ggplot(aes(x=F1, y=F2, color=region)) +
  geom_point(size=2.5, alpha=0.8) +
  labs(title="Comparison of American and British Short 'a' Sounds", 
       x="F1", y="F2", color="Region") +
  scale_color_manual(values=new_pal) +
  theme(plot.title = element_text(face="bold"),
        axis.title.x = element_text(face="bold"),
        axis.title.y = element_text(face="bold")) +
  facet_wrap(vars(word))
```

### UK vs USA F1-Also

```{r, echo=F}
x1 = new_df |> filter(location=="uk", word=="also") |> select(F1)
x2 = new_df |> filter(location %in% c('texas', 'california', 'newyork', 'minnesota'), word=="also") |> select(F1)
t.test(x1, x2, alternative="two.sided", var.equal=FALSE)
```

### UK vs USA F1-Call

```{r, echo=F}
x1 = new_df |> filter(location=="uk", word=="call") |> select(F1)
x2 = new_df |> filter(location %in% c('texas', 'california', 'newyork', 'minnesota'), word=="call") |> select(F1)
t.test(x1, x2, alternative="two.sided", var.equal=FALSE)
```

### UK vs USA Duration-Small

```{r, echo=F}
x1 = new_df |> filter(location=="uk", word=="small") |> select(du)
x2 = new_df |> filter(location %in% c('texas', 'california', 'newyork', 'minnesota'), word=="small") |> select(du)
t.test(x1, x2, alternative="two.sided", var.equal=FALSE)
```

```{r, echo=F}
new_df |> 
  mutate(region = case_when (location == "uk" ~ "UK",
                             # location == "australia" ~ "Australia",
                             location %in% c('texas', 'california', 'newyork', 'minnesota') ~ "Selected USA",
                             TRUE ~ 'elsewhere')) |> 
  filter(region != 'elsewhere') |> 
  ggplot(aes(x=du, color=region)) +
  geom_density() +
  labs(title="American vs British Vowel Duration (All Phones)", 
       x="Duration", color="Region") +
  scale_color_manual(values=new_pal) +
  theme(plot.title = element_text(face="bold"),
        axis.title.x = element_text(face="bold"),
        axis.title.y = element_text(face="bold"))
```

```{r, echo=F}
imp_words4 = c("plastic", "ask", "call", "slabs", "bob", "frog")
new_df |> 
  mutate(region = case_when (location == "uk" ~ "UK",
                             # location == "australia" ~ "Australia",
                             location %in% c('texas', 'california', 'newyork', 'minnesota') ~ "Selected USA",
                             TRUE ~ 'elsewhere')) |> 
  mutate(importance = case_when(word %in% imp_words4 ~ "important",
                                TRUE ~ "unimportant")) |> 
  filter(importance == "important", region != 'elsewhere') |> 
  ggplot(aes(x=du, color=region)) +
  geom_density() +
  labs(title="American vs British Vowel Duration (Selected Phones)", 
       x="Duration", color="Region") +
  scale_color_manual(values=new_pal) +
  theme(plot.title = element_text(face="bold"),
        axis.title.x = element_text(face="bold"),
        axis.title.y = element_text(face="bold"))
```

